---
layout: post
title: 高速フーリエ変換 (任意MOD)
date: 2019-10-14
category: 数学
tags: 数学
---

## 説明
任意MOD $ (\le 2^{30}) $の畳み込みに対応するFFT。
普通に畳み込みを行うと、演算の途中で数がdoubleの精度$2^{53}$を超えてしまう。そこで、$x = a \cdot 2^{15} + b$とし、$a$と$b$を別々に畳み込み合計することで、扱う数を最大で$2^{30}*N$に抑えられる。愚直にたたみ込むと8回程度の畳み込みが必要となるが、複素フーリエ変換を利用することで畳み込み回数を4回にできる。$O(N \log N)$。
{% include a.html code="fft.cpp" %}

ただし、次数が多いと↑のコードは誤差が出てしまうことがある。そこで、11bitずつに分割するコードも用意した。この場合の畳み込み回数は、FFTで$3$回、IFFTで$3$回の計$6$回である。
{% include a.html code="fft3.cpp" %}
